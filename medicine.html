<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ’Š Medicine Tracker</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-pink: #ffb7c5;
            --bg-color: #fdf6f6;
            --text-color: #5a5a5a;
            --cat-blue: #b2e2f2;
            --cat-green: #b2f2bb;
            --cat-purple: #e2b2f2;
            --cat-yellow: #f2eeb2;
            --danger: #ff4d6d;
        }

        body {
            margin: 0;
            background-color: var(--bg-color);
            font-family: 'Poppins', sans-serif;
            color: var(--text-color);
        }

        /* --- SHARED NAV BAR --- */
        .topnav {
            background-color: white;
            display: flex;
            align-items: center;
            padding: 10px 40px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .topnav-left, .topnav-center, .topnav-right { flex: 1; display: flex; align-items: center; }
        .topnav-left { justify-content: flex-start; }
        .topnav-center { justify-content: center; }
        .topnav-right { justify-content: flex-end; }

        .topnav a {
            color: var(--text-color);
            padding: 12px 20px;
            text-decoration: none;
            font-size: 15px;
            font-weight: 600;
            border-radius: 12px;
            transition: 0.3s;
        }

        .topnav a:hover { color: var(--primary-pink); }
        .topnav a.active { background-color: var(--primary-pink); color: white; }

        /* --- MAIN LAYOUT --- */
        .page-content {
            display: flex;
            justify-content: center;
            padding: 40px 20px;
        }

        .container {
            width: 100%;
            max-width: 1000px;
            background: white;
            box-shadow: 0 20px 50px rgba(0,0,0,0.05);
            border-radius: 30px;
            overflow: hidden;
            border: 8px solid white;
        }

        .header {
            background: var(--primary-pink);
            color: white;
            padding: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h2 { margin: 0; }
        .header p { margin: 5px 0 0 0; opacity: 0.9; }

        .btn-danger {
            background: rgba(255, 255, 255, 0.3);
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 15px;
            font-weight: 600;
            transition: 0.3s;
        }

        .btn-danger:hover { background: var(--danger); }

        /* Logic for Two-Column Tracker */
        .content-grid {
            display: grid;
            grid-template-columns: 1.2fr 0.8fr;
            gap: 25px;
            padding: 25px;
        }

        @media (max-width: 900px) { .content-grid { grid-template-columns: 1fr; } }

        .card {
            background: white;
            border: 2px solid #f9f9f9;
            padding: 20px;
            border-radius: 20px;
        }

        .card-title { margin-top: 0; color: #c07c7c; font-size: 1.1rem; }
        .row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        label { font-size: 0.85rem; font-weight: 600; display: block; margin-bottom: 5px; }

        input, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #eee;
            border-radius: 12px;
            font-family: inherit;
            box-sizing: border-box;
        }

        .color-options { display: flex; gap: 10px; margin: 15px 0; }
        .color-dot { width: 25px; height: 25px; border-radius: 50%; cursor: pointer; border: 3px solid transparent; }
        .color-dot.active { border-color: var(--text-color); }

        .save-btn {
            background: var(--primary-pink);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
        }

        .list { display: flex; flex-direction: column; gap: 12px; margin-top: 15px; }
        .entry {
            border-radius: 18px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: popIn 0.3s ease;
        }

        .entry-title { font-weight: 700; }
        .entry-meta { font-size: 0.8rem; opacity: 0.8; }

        .tiny { padding: 6px 12px; border-radius: 10px; border: none; cursor: pointer; font-weight: 600; font-size: 0.75rem; }
        .status-pill { padding: 12px; border-radius: 15px; background: #fff9fa; font-weight: 700; color: #8a6f6f; text-align: center; }

        @keyframes popIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>

    <nav class="topnav">
        <div class="topnav-left">
            <a href="main.html">Home</a>
            <a href="calendar.html">Calendar</a>
        </div>
        
        <div class="topnav-center">
            <a href="medicine.html" class="active">Medicine</a>
        </div>
    
        <div class="topnav-right">
            
            <a href="#account">Account</a>
            <a href="login.html" class="nav-signup" style="background: var(--primary-pink); color: white; margin-left: 10px;">Sign Up</a>
        </div>
    </nav>

    <div class="page-content">
        <div class="container">
            <div class="header">
                <div>
                    <h2>ðŸ’Š Medicine Tracker</h2>
                    <p>Log your daily dosage and timing.</p>
                </div>
                <button class="btn-danger" onclick="clearAll()">Clear All</button>
            </div>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">Add / Edit Entry</h3>
                    <div class="row">
                        <div><label>Date</label><input type="date" id="dateField"></div>
                        <div><label>Time</label><input type="time" id="timeField"></div>
                    </div>
                    <div class="row">
                        <div><label>Medicine Name</label><input type="text" id="nameField"></div>
                        <div><label>Dosage</label><input type="text" id="doseField"></div>
                    </div>
                    <label>Notes</label>
                    <textarea id="notesField" placeholder="How did you feel?"></textarea>

                    <label style="margin-top: 15px;">Color Tag</label>
                    <div class="color-options">
                        <div class="color-dot active" style="background:var(--cat-blue)" onclick="selectColor(this,'var(--cat-blue)')"></div>
                        <div class="color-dot" style="background:var(--cat-green)" onclick="selectColor(this,'var(--cat-green)')"></div>
                        <div class="color-dot" style="background:var(--cat-purple)" onclick="selectColor(this,'var(--cat-purple)')"></div>
                        <div class="color-dot" style="background:var(--cat-yellow)" onclick="selectColor(this,'var(--cat-yellow)')"></div>
                    </div>

                    <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                        <button style="border:none; background:#f4f4f4; padding:12px; border-radius:12px; cursor:pointer;" onclick="resetForm()">Reset</button>
                        <button class="save-btn" onclick="saveEntry()">Save Entry</button>
                    </div>
                    
                    <div class="list" id="list"></div>
                </div>

                <div class="card">
                    <h3 class="card-title">Today</h3>
                    <div class="status-pill" id="todayCount">Taken today: 0</div>
                    <div id="todayDateText" style="font-size:0.8rem; margin: 10px 0; text-align: center;"></div>
                    <div class="list" id="todayList"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const STORAGE_KEY = "medicine_entries_v3";
        let entries = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
        let editingId = null;
        let selectedColor = "var(--cat-blue)";

        function saveStorage() { localStorage.setItem(STORAGE_KEY, JSON.stringify(entries)); }
        function todayISO() { return new Date().toISOString().split("T")[0]; }

        function selectColor(el, color) {
            document.querySelectorAll(".color-dot").forEach(d => d.classList.remove("active"));
            el.classList.add("active");
            selectedColor = color;
        }

        function resetForm() {
            editingId = null;
            document.getElementById("dateField").value = todayISO();
            document.getElementById("timeField").value = "";
            document.getElementById("nameField").value = "";
            document.getElementById("doseField").value = "";
            document.getElementById("notesField").value = "";
        }

        function saveEntry() {
            const date = document.getElementById("dateField").value;
            const name = document.getElementById("nameField").value.trim();
            const dose = document.getElementById("doseField").value.trim();
            if(!date || !name || !dose) return alert("Please fill required fields ðŸŒ¸");

            const data = {
                date,
                time: document.getElementById("timeField").value,
                name, dose,
                notes: document.getElementById("notesField").value.trim(),
                color: selectedColor
            };

            if(editingId) {
                const i = entries.findIndex(e => e.id === editingId);
                entries[i] = { ...data, id: editingId };
            } else {
                entries.push({ ...data, id: Date.now().toString() });
            }

            saveStorage();
            resetForm();
            renderAll();
        }

        function deleteEntry(id) {
            entries = entries.filter(e => e.id !== id);
            saveStorage();
            renderAll();
        }

        function editEntry(id) {
            const e = entries.find(x => x.id === id);
            editingId = id;
            document.getElementById("dateField").value = e.date;
            document.getElementById("timeField").value = e.time;
            document.getElementById("nameField").value = e.name;
            document.getElementById("doseField").value = e.dose;
            document.getElementById("notesField").value = e.notes;
            selectedColor = e.color;
        }

        function renderAll() {
            const list = document.getElementById("list");
            const todayList = document.getElementById("todayList");
            const today = todayISO();
            
            list.innerHTML = "";
            todayList.innerHTML = "";
            
            const todayEntries = entries.filter(e => e.date === today);
            document.getElementById("todayCount").innerText = "Taken today: " + todayEntries.length;
            document.getElementById("todayDateText").innerText = new Date().toDateString();

            entries.forEach(e => {
                const item = createEntryHTML(e, true);
                list.appendChild(item);
                if(e.date === today) todayList.appendChild(createEntryHTML(e, false));
            });
        }

        function createEntryHTML(e, showActions) {
            const div = document.createElement("div");
            div.className = "entry";
            div.style.background = e.color;
            div.innerHTML = `
                <div>
                    <div class="entry-title">${e.name} (${e.dose})</div>
                    <div class="entry-meta">${e.time || 'No time'} | ${e.date}</div>
                </div>
                ${showActions ? `<div>
                    <button class="tiny" style="background:white;" onclick="editEntry('${e.id}')">Edit</button>
                    <button class="tiny" style="background:#ffe6ea; color:var(--danger);" onclick="deleteEntry('${e.id}')">âœ•</button>
                </div>` : ''}
            `;
            return div;
        }

        function clearAll() {
            if(confirm("Delete all records? ðŸŒ·")) { entries = []; saveStorage(); renderAll(); }
        }

        document.getElementById("dateField").value = todayISO();
        renderAll();
    </script>
</body>
</html>